"use strict";function setDefaultAdTargetting(e){var a=[];if(dataLayerObj.length<=0){if(!(dataLayer.length>0))return[];dataLayerObj=dataLayer[0]}if(a=customOffers.setTargettingForCustomOffers(a),void 0!=typeof e&&""!=e&&a.push.apply(a,e),"undefined"!=typeof dataLayerObj){if(void 0!==dataLayerObj.engine_capacity_new&&""!=dataLayerObj.engine_capacity_new&&a.push({key:"engine_capacity",value:dataLayerObj.engine_capacity_new}),void 0!==dataLayerObj.transmission_type_new&&""!=dataLayerObj.transmission_type_new&&a.push({key:"transmission_type_new",value:dataLayerObj.transmission_type_new}),void 0!==location.hostname&&""!=location.hostname&&a.push({key:"domain",value:location.hostname}),void 0!==dataLayerObj.city&&""!=dataLayerObj.city?a.push({key:"city",value:dataLayerObj.city.replace(/\(/g,"_").replace(/\s|\)/g,"")}):a.push({key:"city",value:cityAdTarget.replace(new RegExp(" ","g"),"_")}),void 0!==dataLayerObj.car_segment&&""!=dataLayerObj.car_segment&&a.push({key:"car_segment",value:dataLayerObj.car_segment}),void 0!==dataLayerObj.model_type_new&&""!=dataLayerObj.model_type_new&&a.push({key:"model_type_new",value:dataLayerObj.model_type_new}),void 0!==dataLayerObj.oem_name&&""!=dataLayerObj.oem_name&&a.push({key:"Brand",value:dataLayerObj.oem_name}),void 0!==dataLayerObj.model_name&&""!=dataLayerObj.model_name&&(a.push({key:"Model",value:dataLayerObj.model_name.replace(new RegExp(" ","g"),"_")}),void 0!==dataLayerObj.variant_name&&""!=dataLayerObj.variant_name&&a.push({key:"Variant",value:dataLayerObj.model_name.replace(new RegExp(" ","g"),"_")+"_"+dataLayerObj.variant_name.replace(new RegExp(" ","g"),"_")})),void 0!==dataLayerObj.price_segment_new&&""!=dataLayerObj.price_segment_new?a.push({key:"price",value:dataLayerObj.price_segment_new}):void 0!==dataLayerObj.price_range_segment&&""!=dataLayerObj.price_range_segment&&a.push({key:"price",value:setRangeForPriceSegmentNew(dataLayerObj.price_range_segment)}),void 0!==dataLayerObj.dealer_id&&""!=dataLayerObj.dealer_id&&a.push({key:"dealer_id",value:dataLayerObj.dealer_id}),void 0!==dataLayerObj.news_id_new&&""!=dataLayerObj.news_id_new&&a.push({key:"news_id",value:dataLayerObj.news_id_new}),void 0!==dataLayerObj.fuel_type_new&&""!=dataLayerObj.fuel_type_new&&a.push({key:"fuel_type",value:dataLayerObj.fuel_type_new}),void 0!==dataLayerObj.source&&""!=dataLayerObj.source&&(mediaAdtargetting=dataLayerObj.source.toUpperCase()),void 0!==dataLayerObj.page_type&&""!=dataLayerObj.page_type&&a.push({key:"PageType",value:dataLayerObj.page_type}),void 0!==dataLayerObj.compare_car_details&&""!=dataLayerObj.compare_car_details){for(var t=0;t<dataLayerObj.compare_car_details.split(",").length;t++)compareAdBrand.push(dataLayerObj.compare_car_details.split(",")[t].split("_")[0]),compareAdModel.push(dataLayerObj.compare_car_details.split(",")[t].split("_")[1].replace(new RegExp(" ","g"),"_")),compareAdVariant.push(dataLayerObj.compare_car_details.split(",")[t].split("_")[1].replace(new RegExp(" ","g"),"_")+"_"+dataLayerObj.compare_car_details.split(",")[t].split("_")[2].replace(new RegExp(" ","g"),"_"));""!=compareAdBrand&&a.push({key:"Brand",value:compareAdBrand}),""!=compareAdModel&&(a.push({key:"Model",value:compareAdModel}),""!=compareAdVariant&&a.push({key:"Variant",value:compareAdVariant}))}}else console.error("DataLayer is undefined");return""!=mediaAdtargetting&&null!=mediaAdtargetting&&a.push({key:"gptMedia",value:mediaAdtargetting}),a}function setRangeForPriceSegmentNew(e){if("undefined"==e||!e.includes("lakh")&&!e.includes("crore"))return e;for(var a=e.split(","),t=[],n=0;n<a.length;n++)t.push(a[n].replace("lakh","").replace("lakh","L").replace("+crore","Cabove").replace("crore","C"));return t}function setRangeForPriceSegment(e){return e<=3e5?"upto3L":e<=6e5?"3-6L":e<=12e5?"6-12L":e<=15e5?"12-15L":e<=2e6?"15-20L":"20Labove"}function hideEmptySlotAd(e){var a=$("#"+e.slot.getSlotElementId());a.length&&a.parent().closest("aside").addClass("hide")}idleCb((function(){getScript("https://securepubads.g.doubleclick.net/tag/js/gpt.js")}));var compareAdBrand=[],compareAdModel=[],compareAdVariant=[],googletag=googletag||{};googletag.cmd=googletag.cmd||[];var cityAdTarget="New-Delhi",mediaAdtargetting="";window.objSegmentData={},window.connectoSegmentsData={};var connectoSegments={tempSegmentDataObj:[],arrayJoinAttrVal:[],valueToPass:"",init:function(e){this.insertDataIntoIndexDB(),this.setAdTargetFromSegments(e)},insertDataIntoIndexDB:function(){var e=this,a=!1,t=localStorage.getItem("connectoSgmtCurDateTme");if(t){var n=new Date;t=Date.parse(t);parseInt((n-t)/864e5)>2&&(a=!0)}else a=!0;if(a){var r=new XMLHttpRequest;r.open("get","https://api.connecto.io/getSegmentDefinitionsByProject?projectId=570de84a4f0d925f98343571",!0),r.send(),r.onreadystatechange=function(){4==this.readyState&&200==this.status&&e.createConnectoSegmentDB(r.response)}}},createConnectoSegmentDB:function(e){var a=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(a){var t=a.open("cardekho_connecto",1);t.onupgradeneeded=function(e){var a=t.result;if(e.oldVersion<1)a.createObjectStore("segments",{keyPath:"_id"})},t.onsuccess=function(a){var n=t.result;try{var r=n.transaction(["segments"],"readwrite").objectStore("segments"),o=r.clear(),s=JSON.parse(e);o.onsuccess=function(e){for(var a in s)r.add(s[a]);localStorage.setItem("connectoSgmtCurDateTme",new Date)}}catch(e){}}}},setAdTargetFromSegments:function(e){this.tempSegmentDataObj=[],this.arrayJoinAttrVal=[],this.valueToPass="";try{window._jpConnecto=JSON.parse(localStorage.getItem("_Connecto"))}catch(e){window._jpConnecto={}}if(null!=window._jpConnecto&&0!=Object.keys(window._jpConnecto).length)if(0==Object.keys(window.connectoSegmentsData).length)this.setAdTargetBySegmentsFromDb(e);else{for(var a in window.connectoSegmentsData)this.evaluateSegments(a,window.connectoSegmentsData[a]);window.objSegmentData=this.tempSegmentDataObj,e(setDefaultAdTargetting(this.tempSegmentDataObj))}else e(setDefaultAdTargetting())},evaluateSegments:function(id,evalFunction){var self=this;if(evalFunction){var evalResult=eval(evalFunction);if(void 0!==evalResult&&void 0!=evalResult.result)if(evalResult.result&&void 0!=evalResult.attrDetails){for(var j=0;j<evalResult.attrDetails.length;j++)self.arrayJoinAttrVal.push(evalResult.attrDetails[j].joinAttrVal);self.tempSegmentDataObj.push({key:id.substring(0,20)+"",value:self.arrayJoinAttrVal}),self.arrayJoinAttrVal=[]}else self.valueToPass=evalResult.result,self.tempSegmentDataObj.push({key:id.substring(0,20)+"",value:self.valueToPass+""});else self.valueToPass=evalResult,self.tempSegmentDataObj.push({key:id.substring(0,20)+"",value:self.valueToPass+""})}},callbackForConnectoSegment:function(e){void 0!==e&&void 0!==e._id&&void 0!==e.evalFunction&&(window.connectoSegmentsData[e._id.toString()+""]=e.evalFunction,this.evaluateSegments(e._id,e.evalFunction))},setAdTargetBySegmentsFromDb:function(e){var a=this,t=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(void 0!==t){var n=t.open("cardekho_connecto");n.onerror=function(a){e(setDefaultAdTargetting())},n.onupgradeneeded=function(e){var a=n.result;if(e.oldVersion<1)a.createObjectStore("segments",{keyPath:"_id"})},n.onsuccess=function(){performance.now();var t=n.result.transaction(["segments"],"readonly"),r=t.objectStore("segments");t.oncomplete=function(t){window.objSegmentData=a.tempSegmentDataObj,e(setDefaultAdTargetting(a.tempSegmentDataObj))};var o=r.openCursor();o.onerror=function(e){console.log(e)},o.onsuccess=function(e){var t=e.target.result;t&&(a.callbackForConnectoSegment(t.value),t.continue())}}}else e(setDefaultAdTargetting())}},customOffers={getFieldValue:function(e,a){var t=null,n=JSON.parse(localStorage.getItem("user_custom_offer"))[e];return null!=n&&(t=n[a]),t},getStatus:function(e){var a=this.getFieldValue(e,"lock_value"),t=this.getFieldValue(e,"payment_status"),n=this.getFieldValue(e,"i_m_intrested");return null==a?"unlocked":1==t?"payment_made":n?"intrested":"unlocked"},setTargettingForCustomOffers:function(e){var a=JSON.parse(localStorage.getItem("user_custom_offer"));try{if(null!=a)for(var t in a){var n=t,r=a[n];void 0!=r.dealer_discount&&r.dealer_discount,void 0!=r.offer_value&&r.offer_value,void 0!=r.max_dealer_discount&&r.max_dealer_discount;e.push({key:"o_"+n+"_status",value:this.getStatus(n)}),e.push({key:"o_"+n+"_value",value:void 0!=r.offer_value?""+r.offer_value:""}),e.push({key:"o_"+n+"_dd",value:void 0!=r.dealer_discount?""+r.dealer_discount:""}),e.push({key:"o_"+n+"_mdd",value:void 0!=r.max_dealer_discount?""+r.max_dealer_discount:""})}return e}catch(e){return[]}}};window.addEventListener("load",connectoSegments.init((function(e){googletag.cmd.push((function(){googletag.pubads().set("page_url",location.href),googletag.pubads().disableInitialLoad(),googletag.pubads().setCentering(!0);for(var a=0;a<e.length;a++)googletag.pubads().setTargeting(e[a].key,e[a].value);googletag.pubads().addEventListener("slotRenderEnded",(function(e){e.isEmpty&&hideEmptySlotAd(e)})),googletag.pubads().enableSingleRequest(),googletag.enableServices()}))})),!1);