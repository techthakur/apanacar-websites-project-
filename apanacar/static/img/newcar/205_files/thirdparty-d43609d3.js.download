function guid(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function htmlUnescape(e){return String(e).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function ajaxCall(e,t,n){var o=!1,c=!1;if(window.XMLHttpRequest&&"withCredentials"in(o=new XMLHttpRequest)&&(c=!0),!o)return!1;o.onreadystatechange=function(){n&&4==this.readyState&&200==this.status&&n(this.responseText)},t?(o.open("POST",e,!0),o.setRequestHeader&&o.setRequestHeader("Content-type","application/json")):o.open("GET",e,!0),c&&(o.withCredentials=!0),t?o.send(JSON.stringify(t)):o.send(null)}function insertContent(e,t,n){var o;_TConnecto.messageContentInserted[n.id]||null==e||(n.notification.hasDynamicContent&&n.notification.segmentId&&""!==n.notification.segmentId&&n.notification.segmentEvalFunctionResult.result&&(Array.isArray(n.notification.segmentEvalFunctionResult.attrDetails)&&0<n.notification.segmentEvalFunctionResult.attrDetails.length&&Array.isArray(n.notification.segmentEvalFunctionResult.attrDetails[0].events)&&0<n.notification.segmentEvalFunctionResult.attrDetails[0].events.length&&(o=n.notification.segmentEvalFunctionResult.attrDetails[0].events[0].properties||n.notification.segmentEvalFunctionResult.attrDetails[0].events[0].data||{}),t=_TConnecto.Mustache.render(t,{dynamicContentVariables:_TConnecto.getVariables(),dataLayer:_TConnecto.dataLayer,segmentResult:o})),e.contentWindow.document.open("text/html","replace"),e.contentWindow.document.write(t),e.contentWindow.document.close(),_TConnecto.messageContentInserted[n.id]=!0)}function _getWindowHeight(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0}function _getWindowYscroll(){return window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop||0}function _getDocHeight(){return Math.max(document.body.scrollHeight||0,document.documentElement.scrollHeight||0,document.body.offsetHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0,document.documentElement.clientHeight||0)}function getScrollPercentage(){return(_getWindowYscroll()+_getWindowHeight())/_getDocHeight()*100}function isScrollable(){return _getDocHeight()>_getWindowHeight()}function toggleOnEnterExit(e){e.notification.exitIntent.toggleOnEnterExitVar&&(document.getElementsByTagName("html")[0].addEventListener("mouseenter",(function(){document.getElementById("connecto-modal-overlay-"+e.id).style.display="none",document.getElementById("connecto_"+e.id+"_bg_element").style.display="none"})),document.getElementsByTagName("html")[0].addEventListener("mouseleave",(function(){document.getElementById("connecto-modal-overlay-"+e.id).style.display="block",document.getElementById("connecto_"+e.id+"_bg_element").style.display="block"})))}function showContent(e,t,n,o,c){if(0<o&&isScrollable())window.addEventListener("scroll",(function(){getScrollPercentage()>o?_TConnecto.messageContentInserted[c.id]&&c.notification.hideOnScrollUp?0==_getWindowYscroll()?document.getElementById("container-notification-frame-"+c.id).contentWindow.hideIfShown():document.getElementById("container-notification-frame-"+c.id).contentWindow.showIfHidden():_TConnecto.segmentAndClientSideVariablesOk(c)&&insertContent(e,t,c):_TConnecto.messageContentInserted[c.id]&&c.notification.hideOnScrollUp&&document.getElementById("container-notification-frame-"+c.id).contentWindow.hideIfShown()}),!1);else if(c.notification.exitIntent&&c.notification.exitIntent.showExitIntent)c.notification.dontShowAfter&&0<c.notification.dontShowAfter&&_TConnecto.timeouts.push(setTimeout((function(){_TConnecto.idToExitIntentObjMap[c.id]&&_TConnecto.idToExitIntentObjMap[c.id].disable&&_TConnecto.idToExitIntentObjMap[c.id].disable()}),1e3*c.notification.dontShowAfter)),_TConnecto.timeouts.push(setTimeout((function(){var n=exitIntentLib(document.getElementById("container-notification-frame-"+c.id),{agressive:c.notification.exitIntent.useAgressiveMode||!1,sensitivity:c.notification.exitIntent.sensitivity||65,cookieExpire:c.notification.exitIntent.cookieExpire||0,timer:c.notification.exitIntent.timer||0,cookieDomain:c.notification.exitIntent.cookieDomain||"",id:c.id,callback:function(){_TConnecto.segmentAndClientSideVariablesOk(c)&&(insertContent(e,t,c),toggleOnEnterExit(c))}});_TConnecto.idToExitIntentObjMap[c.id]=n}),n));else if(c.notification.notificationOriginSelector){var i,a=c.notification.notificationOriginSelector.split(",");for(i in a)for(var s=document.querySelectorAll(a[i].trim())||[],r=0;r<s.length;r++)s[r].addEventListener(c.notification.notificationOriginEvent,(function(){_TConnecto.segmentAndClientSideVariablesOk(c)&&insertContent(e,t,c)}))}else _TConnecto.timeouts.push(setTimeout((function(){_TConnecto.segmentAndClientSideVariablesOk(c)&&insertContent(e,t,c)}),n))}function _loadScript(e,t){var n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(n.onreadystatechange=null,t&&t())}:n.onload=function(){t&&t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)}function _checkValueMatch(e,t,n){var o=!1;switch(e){case 1:0<=t.indexOf(n)&&(o=!0);break;case 2:-1===t.indexOf(n)&&(o=!0);break;case 3:t==n&&(o=!0);break;case 4:t!=n&&(o=!0);break;case 5:n<t&&(o=!0);break;case 6:t<n&&(o=!0);break;case 7:n<=t&&(o=!0);break;case 8:t<=n&&(o=!0);break;case 9:null!=t&&(o=!0);break;case 10:null==t&&(o=!0)}return o}function _processConnectoMessages(){if(_TConnecto.messages)for(var e=0;e<_TConnecto.messages.length;e++){var t,n,o,c=_TConnecto.messages[e];_TConnecto.messageProcessed[c.id]||_TConnecto.messageContentInserted[c.id]||(!c.notification.hasDynamicContent||_TConnecto.Mustache?!_TConnecto.pageLoaded&&12===c.notification.notification_type||(_TConnecto.pageLoaded&&_TConnecto.Sizzle||!c.notification.clientSideVariableMatches||!(0<c.notification.clientSideVariableMatches.length)?(n=htmlUnescape(c.snippet),_TConnecto.messageMap[c.id]=c,_TConnecto.messageProcessed[c.id]=!0,12===c.notification.notification_type?_TConnecto.embedElements[c.notification.embeddedSlot]?(t=_TConnecto.embedElements[c.notification.embeddedSlot]).innerHTML=n:_TConnecto.messageContentInserted[c.id]=!0:((t=document.createElement("div")).setAttribute("id","connecto_"+c.id),t.innerHTML=n,document.body?document.body.insertBefore(t,null):(o=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,o)),5!==c.notification.closeBehaviour&&(n=document.getElementById("container-notification-frame-"+c.id),o=htmlUnescape(c.innerHTML),showContent(n,o=!c.notification.hasDynamicContent||c.notification.segmentId&&""!==c.notification.segmentId?o:_TConnecto.Mustache.render(o,{dynamicContentVariables:_TConnecto.getVariables(),dataLayer:_TConnecto.dataLayer}),c.delay,c.scroll,c))):_TConnecto._loadSizzleJS()):__co_loadMustache())}}function __co_loadMustache(){var e;"undefined"!=typeof Mustache&&(e=Mustache),"undefined"!=typeof require&&"undefined"!=typeof requirejs&&require&&requirejs?(require.config({paths:{_co_mustache:"https://cdnjs.cloudflare.com/ajax/libs/mustache.js/0.8.1/mustache.min"}}),require(["_co_mustache"],(function(e){_TConnecto.Mustache=e}))):_loadScript("https://cdnjs.cloudflare.com/ajax/libs/mustache.js/0.8.1/mustache.min.js",(function(){Mustache&&(_TConnecto.Mustache=Mustache,Mustache=e,_processConnectoMessages())}))}function exitIntentLib(e,t){function n(e,t){return void 0===e?t:e}function o(e){var t=24*e*60*60*1e3;return(e=new Date).setTime(e.getTime()+t),"; expires="+e.toGMTString()}function c(e){e.clientY>g||s("viewedOnExit"+h,"true")&&!d||(T=setTimeout(r,_))}function i(e){T&&(clearTimeout(T),T=null)}function a(e){y||s("viewedOnExit"+h,"true")&&!d||e.metaKey&&76==e.keyCode&&(y=!0,T=setTimeout(r,_))}function s(e,t){return document.cookie.split("; ").reduce((function(e,t){return t=t.split("="),e[t[0]]=t[1],e}),{})[e]===t}function r(){l(),f()}function l(){e&&(e.style.display="block"),u()}function u(e){void 0!==(e=e||{}).cookieExpire&&(p=o(e.cookieExpire)),!0===e.sitewide&&(v=";path=/"),void 0!==e.cookieDomain&&(C=";domain="+e.cookieDomain),document.cookie="viewedOnExit"+h+"=true"+p+C+v,S.removeEventListener("mouseleave",c),S.removeEventListener("mouseenter",i),S.removeEventListener("keydown",a)}var d=(t=t||{}).aggressive||!1,g=n(t.sensitivity,65),m=n(t.timer,1e3),_=n(t.delayExit,200),f=t.callback||function(){},p=o(t.cookieExpire)||"",C=t.cookieDomain?";domain="+t.cookieDomain:"",v=!0===t.sitewide?";path=/":"",h=t.id||"",T=null,S=document.getElementsByTagName("html")[0];setTimeout((function(){S.addEventListener("mouseleave",c),S.addEventListener("mouseenter",i),S.addEventListener("keydown",a)}),m);var y=!1;return{fire:l,disable:u}}var _connectoEventStore={vars:{storageHandle:"_Connecto",maxEvents:1e3,sliceBy:10,maxSize:2e5},getHtmlStorage:function(e){if(this.vars.localStore)return this.vars.localStore;var t=e.getItem(this.vars.storageHandle);if(t)try{return JSON.parse(t)}catch(t){return e.removeItem(this.vars.storageHandle),this.initHtmlStorage(e)}return null},initHtmlStorage:function(e){if(e.getItem(this.vars.storageHandle))return this.getHtmlStorage(e);var t={source:document.referrer,landing_page:document.URL,firstVisitOn:new Date,events:[],identity:{}};return e.setItem(this.vars.storageHandle,JSON.stringify(t)),t},initPersistentStorage:function(){return this.initHtmlStorage(localStorage)},saveHtmlStorage:function(e,t){try{e.setItem(this.vars.storageHandle,JSON.stringify(t))}catch(n){JSON.stringify(t).length>this.vars.maxSize&&t.events.length>this.vars.sliceBy&&(t.events=t.events.slice(this.vars.sliceBy),this.saveHtmlStorage(e,t)),console.log(n)}},savePersistentStorage:function(){this.saveHtmlStorage(localStorage,this.vars.localStore)},prunePayload:function(e){try{var t=JSON.parse(JSON.stringify(e));return delete t.messageId,delete t.userId,delete t.anonymousId,delete t.writeKey,delete t.channel,delete t.sentAt,t.context&&(t.context.url=t.context.url.replace(/^.*\/\/[^\/]+/,""),delete t.context.library),t}catch(e){return null}},addEvent:function(e,t){e.events||(e.events=[]),e.events.push(this.prunePayload(t)),e.events.length>this.vars.maxEvents&&(e.events=e.events.slice(this.vars.sliceBy))},saveEvent:function(e){this.vars.localStore||this.init(),this.addEvent(this.vars.localStore,e),this.savePersistentStorage()},setValue:function(e,t,n){e[t]=n},saveValue:function(e,t){this.vars.localStore||this.init(),this.setValue(this.vars.localStore,e,t),this.savePersistentStorage()},getFromHtmlStorage:function(e){var t=this.getHtmlStorage(localStorage);return t&&t[e]?t[e]:null},init:function(){this.vars.localStore=this.initHtmlStorage(localStorage)}},_connecto=_connecto||[];_connecto.HTML5_PERMISSION_KEY="html5PermissionStatus",_connecto.askedForHtml5Permission=!1,_connecto.trackedHtml5Response=!1,_connecto.closeAfterSubscription=!1;var objAgent=navigator.userAgent,objbrowserName=navigator.appName,objfullVersion=""+parseFloat(navigator.appVersion),objBrMajorVersion=parseInt(navigator.appVersion,10),objOffsetVersion;if(-1!=(objOffsetVersion=objAgent.indexOf("Chrome"))&&(objbrowserName="Chrome",objfullVersion=objAgent.substring(objOffsetVersion+7)),objBrMajorVersion=parseInt(""+objfullVersion,10),isNaN(objBrMajorVersion)&&(objfullVersion=""+parseFloat(navigator.appVersion),objBrMajorVersion=parseInt(navigator.appVersion,10)),!window.Notification||"denied"!==Notification.permission&&"granted"!==Notification.permission||(_connecto.trackedHtml5Response=!0),_connecto.onPushSubscription=function(e,t){var n=e.endpoint;e.subscriptionId&&e.endpoint&&-1===e.endpoint.indexOf(e.subscriptionId)&&(n=e);var o=_connecto.getFromConnectoStorage("pushSubscriptionEndpoint");if(o!=n){var c=_connecto.getAnonymousId(),i=_connecto.getFromConnectoStorage("userId");i||(i=c),_connecto.identify(i,{$chromePushDetails:JSON.stringify(e)},null,(function(){if(_connecto.saveToConnectoStorage("pushSubscriptionEndpoint",n),_connecto.trackedHtml5Response||(_connecto.trackedHtml5Response=!0,o||_connecto.getUrlForUserAction(2),_connecto.pushChomePermissionEventToCassandra(2)),_connecto.closeAfterSubscription&&window.close(),null===_connecto.getFromConnectoStorage(_connecto.HTML5_PERMISSION_KEY)){var e={status:Notification.permission,time:new Date};_connecto.saveToConnectoStorage(_connecto.HTML5_PERMISSION_KEY,e),_connecto.setValueInCookie(_connecto.HTML5_PERMISSION_KEY,JSON.stringify(e)),null!==t&&t()}}))}},_connecto.subscribeDevice=function(e,t,n){navigator.serviceWorker.ready.then((function(e){"default"!==Notification.permission||_connecto.askedForHtml5Permission||(_connecto.askedForHtml5Permission=!0,sessionStorage.getItem("haveShownOptInDialog")||(_connecto.getUrlForUserAction(1),_connecto.pushChomePermissionEventToCassandra(1),sessionStorage.setItem("haveShownOptInDialog",!0)));var o={userVisibleOnly:!0};_connecto.VAPIDDetails&&_connecto.VAPIDDetails.publickey&&(o.applicationServerKey=_connecto.urlB64ToUint8Array(_connecto.VAPIDDetails.publickey)),e.pushManager.subscribe(o).then((function(e){_connecto.onPushSubscription(e,t)})).catch((function(e){if(console.log("Error while subscribing: "+e),"denied"!==Notification.permission||_connecto.trackedHtml5Response||(_connecto.getUrlForUserAction(3),_connecto.trackedHtml5Response=!0,_connecto.pushChomePermissionEventToCassandra(3)),null===_connecto.getFromConnectoStorage(_connecto.HTML5_PERMISSION_KEY)){var t={status:Notification.permission,time:new Date};_connecto.saveToConnectoStorage(_connecto.HTML5_PERMISSION_KEY,t),_connecto.setValueInCookie(_connecto.HTML5_PERMISSION_KEY,JSON.stringify(t)),null!==n&&n()}}))}))},_connecto.pushForChrome=function(e,t,n){navigator.serviceWorker.register("/serviceworker.js").then((function(){_connecto.subscribeDevice(e,t,n)})).catch((function(e){console.log(e)}))},_connecto.urlB64ToUint8Array=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(t),o=new Uint8Array(n.length),c=0;c<n.length;++c)o[c]=n.charCodeAt(c);return o},_connecto.isPushSupported=function(){return navigator&&navigator.serviceWorker?window.Notification?!!(window.PushManager||navigator&&navigator.push)||(console.log("Pushmanager not found."),!1):(console.log("window.Notification not found."),!1):(console.log("Service Workers not supported on this browser. Please upgrade to Chrome 50+"),!1)},_connecto.initPushRegistration=function(e,t,n,o){e&&(_connecto.closeAfterSubscription=!0),_connecto.isPushSupported()&&"Chrome"==objbrowserName&&objBrMajorVersion>=50?_connecto.pushForChrome(e,n,o):null!==t&&t()},_connecto.setSessionDetailsForAsk=function(){sessionStorage.setItem("HTML5_PERMISSION_KEY","true"),_connecto.initPushRegistration()},_connecto.askPermissionViaTimeout=function(e){_connecto.isPushSupported()&&"default"===Notification.permission&&setTimeout((function(){_connecto.setSessionDetailsForAsk()}),1e3*e)},_connecto.urlChanged=function(e){var t=sessionStorage.getItem("HTML5_PERMISSION_KEY");if(_connecto.isPushSupported()&&"default"===Notification.permission&&"true"!==t){var n=location.href,o=_connecto.scriptParametersPerProperty.pushAskUrl,c=_connecto.scriptParametersPerProperty.pushAskTime,i=o&&o.value;n&&i&&n.includes(i)&&(c&&c.enabled&&c.value?_connecto.askPermissionViaTimeout(c.value):_connecto.setSessionDetailsForAsk())}},_connecto.addPopStateEventListener=function(){window.addEventListener("popstate",_connecto.urlChanged)},_connecto.decideAskType=function(){var e=_connecto.scriptParametersPerProperty.pushAskUrl,t=_connecto.scriptParametersPerProperty.pushAskTime;return t&&e&&t.enabled&&e.enabled||e&&e.enabled?_connecto.addPopStateEventListener():t&&t.enabled?t.value?_connecto.askPermissionViaTimeout(t.value):function(){}:void 0},_connecto.fetchScriptParams=function(){var e=_connecto.writeKey,t={context:{url:document.location.href,library:{name:"connecto.js",version:"1.0"}},properties:{writeKey:e}};fetch("https://api.connecto.io/getConnectoScriptParams",{method:"post",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)}).then((function(e){e.json().then((function(e){_connecto.scriptParametersPerProperty=e,_connecto.decideAskType()}))})).catch((function(e){console.log(e)}))},_connecto.isPushSupported()&&"default"===Notification.permission){var haveAlreadyAskedOnce=sessionStorage.getItem("HTML5_PERMISSION_KEY");"true"!==haveAlreadyAskedOnce&&_connecto.fetchScriptParams()}var _connecto=_connecto||[],STR_ANONYMOUS_ID="anonymousId",STR_USER_ID="userId";_connecto.getConnectoStorage=function(){return _connectoEventStore.getHtmlStorage(localStorage)},_connecto.initConnectoStorage=function(){_connectoEventStore.init()},_connecto.saveToConnectoStorage=function(e,t){_connectoEventStore.saveValue(e,t)},_connecto.getFromConnectoStorage=function(e){return _connectoEventStore.getFromHtmlStorage(e)},_connecto.getConnectoId=function(){return _connecto.getFromConnectoStorage(STR_ANONYMOUS_ID)},_connecto.getAnonymousId=function(){return _connecto.getConnectoId()},_connecto.getIdentity=function(){var e=_connecto.getFromConnectoStorage(STR_USER_ID);return("string"!=typeof e||""==e.trim())&&(e=_connecto.getConnectoId()),e},_connecto.getProfileId=function(){return _connecto.getFromConnectoStorage(STR_USER_ID)},_connecto.getSessionCount=function(){return _connecto.getConnectoId()?2:1},_connecto.pushChomePermissionEventToCassandra=function(e){var t,n={};switch(e){case 1:n.userAction="asked",t="Push Permission Asked";break;case 2:n.userAction="allowed",t="Push Permission Allowed";break;case 3:n.userAction="denied",t="Push Permission Denied"}_connecto.track(t,n,null,(function(){}))},_connecto.getUrlForUserAction=function(e){var t=_connecto.getIdentity(),n=document.location.protocol+"//push.connecto.io/chromePush/track";n+="?writeKey="+encodeURIComponent(_connecto.writeKey),n+="&actionType="+encodeURIComponent(e),n+="&profileId="+encodeURIComponent(t),n+="&domain="+encodeURIComponent(window.location.origin),fetch(n)},_connecto.getQueryStringValue=function(e){return unescape(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+escape(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))},_connecto.getDefaultPayload=function(e,t){for(var n=_connecto.getConnectoId(),o=_connecto.getIdentity(),c=t||new Date,i={utm_source:_connecto.getQueryStringValue("utm_source"),utm_medium:_connecto.getQueryStringValue("utm_medium"),utm_campaign:_connecto.getQueryStringValue("utm_campaign"),utm_content:_connecto.getQueryStringValue("utm_content"),utm_term:_connecto.getQueryStringValue("utm_term")},a=Object.keys(i),s=0;s<a.length;s++){var r=a[s];i[r]&&null!=i[r]||delete i[r]}return{messageId:guid(),type:e,userId:o,anonymousId:n,timestamp:c,sessioncount:_connecto.getSessionCount(),context:{url:document.location.href,utm_param:i,library:{name:"connecto.js",version:"1.0"}},writeKey:_connecto.writeKey,channel:"web"}},_connecto.ajax=function(e){var t=e.url,n=e.type||"POST",o=e.dataType||"text/plain",c=e.withCredentials||!0,i=e.success,a=e.data||null,s=e.headers,r=new XMLHttpRequest;r.open(n,t,!0),r.setRequestHeader("content-type",o);for(var l in s)r.setRequestHeader(l,s[l]);r.withCredentials=c,r.onreadystatechange=function(){i&&4==this.readyState&&200==this.status&&i(this.responseText)},a?r.send(JSON.stringify(a)):r.send()};var setFreshConnectoIdsToLocalStorage=function(){var e=guid();_connecto.saveToConnectoStorage(STR_ANONYMOUS_ID,e),_connecto.saveToConnectoStorage(STR_USER_ID,e)},setUserIdInLocalStorage=function(e){_connecto.saveToConnectoStorage(STR_USER_ID,e)};_connecto.validateProfileTraits=function(e,t,n){var o=_connecto.getIdentity();return!((n||e&&o&&e===o)&&!_connecto._checkAndUpdateProfileTraits(t,n))},_connecto._checkAndUpdateProfileTraits=function(e,t){var n=_connecto.getFromConnectoStorage("lastTraits")||{};if(t||JSON.stringify(e)!==JSON.stringify(n)){for(var o in e){var c=e[o],i=n[o];i&&i==c&&!t&&delete e[o]}return!0}return!1},_connecto.trackUserIds=function(){try{var e=JSON.parse(localStorage.getItem("MOE_DATA"));if(null===e)return;var t={};if(e.USER_DATA&&e.USER_DATA.attributes){var n=e.USER_DATA.attributes.filter((function(e){return"USER_ATTRIBUTE_UNIQUE_ID"===e.key})),o=n.length>0?n[0]:{};o.value&&""!==o.value&&(t.moengage_user_id=o.value)}var c=e.HARD_ASK_STATUS,i=e.SUBSCRIPTION_DETAILS;c&&"granted"===c&&i&&i.raw&&(i.keys||i.raw.keys)&&(t.$chromePushDetails=JSON.stringify({endpoint:i.raw.endpoint,expirationTime:i.raw.expirationTime,keys:{p256dh:i.raw.keys?i.raw.keys.p256dh:i.keys.p256dh,auth:i.raw.keys?i.raw.keys.auth:i.keys.auth}})),Object.keys(t).length>0&&_connecto.identify(_connecto.getIdentity(),t,null,(function(e){if(e||t.$chromePushDetails&&_connecto.getUrlForUserAction(2),null===_connecto.getFromConnectoStorage(_connecto.HTML5_PERMISSION_KEY)){var n={status:Notification.permission,time:new Date};_connecto.saveToConnectoStorage(_connecto.HTML5_PERMISSION_KEY,n),_connecto.setValueInCookie(_connecto.HTML5_PERMISSION_KEY,JSON.stringify(n))}}))}catch(e){}},_connecto.identify=function(e,t,n,o){e&&null!==e&&""!==e?(function(){if(e instanceof Function||!(e||t&&0!==Object.keys(t).length))o&&o();else if(_connecto.getConnectoId()){var c=!1;if(n&&n.force&&!0===n.force&&(c=!0),_connecto.validateProfileTraits(e,t,c)&&0!==Object.keys(t).length){e&&setUserIdInLocalStorage(e);var i=_connecto.getDefaultPayload("identify",new Date);i.traits=t,n&&n.url&&(i.context.url=n.url);var a=document.location.protocol+"//api.connecto.io/identify";_connecto._sendAndProcessResponse(a,i,o,_connecto.cbToSetAnonymousId)}else o&&o(!0)}else o&&o()})():setTimeout((function(){e=_connecto.getIdentity(),_connecto.identify(e,t,n,o)}),1e3)},_connecto.setIdentifyCookie=function(e){!(function(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var c="expires="+o.toUTCString();document.cookie=e+"="+t+"; "+c+"; path=/; sameSite=None; secure=true;"})("identifyCookie",e.identifyCookie,3650)},_connecto.saveTraitsToLocalStorage=function(e){for(var t=_connecto.getFromConnectoStorage("lastTraits")||{},n=Object.keys(e),o=0;o<n.length;o++){var c=n[o];t[c]=e[c]}_connecto.saveToConnectoStorage("lastTraits",t)},_connecto._sendAndProcessResponse=function(e,t,n,o){t.sentAt=new Date,_connecto.ajax({url:e,data:t,success:function(e){if(res=JSON.parse(e),"identify"===t.type){var c=t.traits;_connecto.saveTraitsToLocalStorage(c)}o&&o(res),n&&n(),res.identifyCookie&&_connecto.setIdentifyCookie(res)}}),_connectoEventStore.saveEvent(t)},_connecto.setValueInCookie=function(e,t){!(function(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var c="expires="+o.toUTCString();document.cookie="_CO_"+e+"="+escape(t)+"; "+c+"; sameSite=None; secure=true;"})(e,t,3650)},_connecto.cbToSetAnonymousId=function(e){if(e.anonymousId){var t=e.anonymousId;t!==_connecto.getConnectoId()&&_connecto.saveToConnectoStorage(STR_ANONYMOUS_ID,t),_connecto.setValueInCookie("type","connecto"),_connecto.setValueInCookie(STR_ANONYMOUS_ID,t)}},_connecto.page=function(e,t,n){if(_connecto.getConnectoId()){var o=_connecto.getDefaultPayload("page",new Date);e&&(o.data=e),t&&t.url&&(o.context.url=t.url);var c=document.location.protocol+"//api.connecto.io/page";_connecto._sendAndProcessResponse(c,o,n,_connecto.cbToSetAnonymousId)}else n&&n()},_connecto.track=function(e,t,n,o){if(_connecto.getConnectoId()){var c=_connecto.getDefaultPayload("track",new Date);c.event=e,c.properties=t,-1!==e.indexOf("Push Permission")&&c&&c.context&&c.context.library&&(c.context.library.name="connecto-backend"),n&&n.url&&(c.context.url=n.url);var i=document.location.protocol+"//api.connecto.io/track";_connecto._sendAndProcessResponse(i,c,o,_connecto.cbToSetAnonymousId)}else o&&o()},_connecto.generatedEvents=function(e,t,n,o){if(_connecto.getConnectoId()){var c=_connecto.getDefaultPayload("track",new Date);c.event=e,c.properties=t,-1!==e.indexOf("Push Permission")&&c&&c.context&&c.context.library&&(c.context.library.name="connecto-backend"),n&&n.url&&(c.context.url=n.url);var i=document.location.protocol+"//api.connecto.io/generatedEvents";_connecto._sendAndProcessResponse(i,c,o,_connecto.cbToSetAnonymousId)}else o&&o()},_connecto.transaction=function(e,t,n,o){if(_connecto.getConnectoId()){var c=_connecto.getDefaultPayload("transaction",new Date);c.event=e,c.properties=t,n&&n.url&&(c.context.url=n.url);var i=document.location.protocol+"//api.connecto.io/transaction";_connecto._sendAndProcessResponse(i,c,o,_connecto.cbToSetAnonymousId)}else o&&o()},_connecto.onload=function(e){e&&e()},_connecto.processOnLoad=function(){for(var e=_connecto.length,t=0;e>t;t++)_connecto._processPushedFunction(_connecto.shift())},_connecto._processPushedFunction=function(e){var t=e.shift();_connecto[t]&&_connecto[t].apply(null,e)},_connecto.push=function(e){_connecto._processPushedFunction(e)},(function(){if(_connecto.initialized)window.console&&console.error&&console.error("Connecto Snippet Included Twice");else{_connecto.initialized=!0,_connecto.initConnectoStorage();var e=_connecto.getAnonymousId(),t=_connecto.getProfileId();e?t||setUserIdInLocalStorage(e):setFreshConnectoIdsToLocalStorage(),_connecto.processOnLoad()}})();var _TConnecto=_TConnecto||{};_TConnecto.initPage=function(e){if(_TConnecto.clearMessages(),_TConnecto.initialized=!1,_TConnecto.pageLoaded=_TConnecto.pageLoaded||!1,_TConnecto.variables=_TConnecto.variables||{},_TConnecto.messages=null,_TConnecto.messageContentInserted={},_TConnecto.messageProcessed={},_TConnecto.embedElements={},_TConnecto.messageMap={},_TConnecto.usesNewVariables=!1,_TConnecto.idToExitIntentObjMap)for(var t in _TConnecto.idToExitIntentObjMap)_TConnecto.idToExitIntentObjMap[t]&&_TConnecto.idToExitIntentObjMap[t].disable&&_TConnecto.idToExitIntentObjMap[t].disable();if(_TConnecto.idToExitIntentObjMap={},_TConnecto.timeouts&&0<_TConnecto.timeouts.length)for(var n=0;n<_TConnecto.timeouts.length;n++)clearTimeout(_TConnecto.timeouts[n]);_TConnecto.timeouts=[],e&&fetchMessages(),_TConnecto.setUtmParamsInSessionStorage()},_TConnecto.setUtmParamsInSessionStorage=function(){try{var e,t=document.referrer,n=window.location.toString(),o=n.split("?"),c=new Set(["utm_source","utm_medium","utm_content","utm_campaign","utm_term"]),i=!1;if(1<o.length){var a,s=o[1].split("&");for(a in s){var r=s[a].split("="),l=r[0],u=r[1];c.has(l)&&(sessionStorage.setItem(l,decodeURIComponent(u)),i=!0)}}!t||i||null!=sessionStorage.getItem("utm_source")&&null!=sessionStorage.getItem("utm_medium")?i||!n.includes("gclid")||null!=sessionStorage.getItem("utm_source")&&null!=sessionStorage.getItem("utm_medium")?t||i||null!=sessionStorage.getItem("utm_source")&&null!=sessionStorage.getItem("utm_medium")||(sessionStorage.setItem("utm_source","direct"),sessionStorage.setItem("utm_medium","none")):(sessionStorage.setItem("utm_source","google"),sessionStorage.setItem("utm_medium","cpc")):(e=new URL(t).hostname.replace("www.",""),t.includes("facebook")||t.includes("youtube")||t.includes("twitter")||t.includes("linkedin")||t.includes("plus.google")||t.includes("pinterest")||t.includes("instagram")?(sessionStorage.setItem("utm_source",e),sessionStorage.setItem("utm_medium","social")):t.includes("google")||t.includes("yahoo")||t.includes("bing")||t.includes("ask")||t.includes("msn")?(sessionStorage.setItem("utm_source",e),sessionStorage.setItem("utm_medium","organic")):(t.includes("aclk")||t.includes("googleads.g.doubleclick.net"))&&(sessionStorage.setItem("utm_source","google"),sessionStorage.setItem("utm_medium","cpc")))}catch(e){console.error("Exception occurred in storing UTM params to session storage",e)}};var fetchMessages=function(){_TConnecto.dataLayer=_TConnecto.dataLayer||window.dataLayer;var e=_TConnecto.getFromConnectoStorage("firstVisitOn"),t=_TConnecto.getFromConnectoStorage("landingPage"),n={};try{_TConnecto.updateConnectoLogs();var o=_TConnecto.initConnectoStorage().source,c=_TConnecto.getConnectoLogs(),i=_TConnecto.getEventsSummary(),a=1,s=1,r=null;c&&c.sessions&&0<(a=c.sessions.length)&&(s=c.sessions[a-1].pagesViewed,r=c.sessions[a-1].startTime),e&&(n.firstVisitTime=e),i&&(n.eventsSummary=i),t&&(n.landingPage=t),o&&(n.referer=o),a&&(n.sessionNum=a),s&&(n.sessionLen=s),r&&(n.sessionStart=r),_TConnecto.engageId&&(n.engageId=_TConnecto.engageId),_TConnecto.getVariables()&&(n.customVariables=JSON.stringify(_TConnecto.getVariables())),_TConnecto.licenseKey&&(n.licenseKey=_TConnecto.licenseKey);var l=_TConnecto.getAnonymousId(),u=_TConnecto.getIdentity(),d={};u&&(d.userId=u),l&&(d.anonymousId=l),d&&(n.segmentData=JSON.stringify(d)),_TConnecto.saveToConnectoStorage("lastVisitTime",new Date)}catch(e){console.log("Error : err"+e),console.log("Error : stack"+e.stack)}ajaxCall(document.location.protocol+"//server.connecto.io/?v=1.2&url="+encodeURIComponent(window.location),n,(function(e){if(res=JSON.parse(e),"1"==res.response||"2"==res.response){for(var t=0;t<res.messages.length;t++){var n=res.messages[t];if(n.imagesToPreload)for(var o=0;o<n.imagesToPreload.length;o++)document.images&&n.imagesToPreload[o]&&((new Image).src=n.imagesToPreload[o])}_TConnecto.messages=res.messages,res.groups&&(_TConnecto.groups=res.groups),"interactive"==document.readyState||"complete"==document.readyState?_TConnecto._processOnPageLoad():window.addEventListener("DOMContentLoaded",_TConnecto._processOnPageLoad)}}))};_TConnecto.trackConversion=function(e){(e=e||window._connecto_cur_msg_id)&&(ajaxCall(document.location.protocol+"//server.connecto.io/action?action=8&id="+e),_TConnecto.resetMessageId())},_TConnecto.resetMessageId=function(){delete window._connecto_cur_msg_id},_TConnecto.clearMessages=function(){if("object"==typeof _TConnecto.messageContentInserted)for(var e in _TConnecto.messageContentInserted)(e=document.getElementById("connecto_"+e))&&e.remove()},_TConnecto.initPage(),_TConnecto.addVariable=function(e,t){_TConnecto.usesNewVariables=!0,e&&t&&(_TConnecto.variables[e]=t)},_TConnecto.getVariables=function(){if(!_TConnecto.usesNewVariables&&(_TConnecto.customVariables&&(_TConnecto.variables=_TConnecto.customVariables),_TConnecto.dynamicVariables))for(var e in _TConnecto.dynamicVariables)_TConnecto.variables[e]=_TConnecto.dynamicVariables[e];return _TConnecto.variables},_TConnecto.segmentAndClientSideVariablesOk=function(e){var t=e.notification.segmentId;return _TConnecto._evaluateSegmentEvalFn(e.notification),!(t&&""!==t&&!e.notification.segmentEvalFunctionResult.result||e.notification.clientSideVariableMatches&&0<e.notification.clientSideVariableMatches.length&&!_TConnecto.matchClientSideVariables(e.notification.clientSideVariableMatches,e.notification))},_TConnecto.matchClientSideVariables=function(andClauses,notification){for(var conjunction=!0,i=0;i<andClauses.length;i++){for(var disjunction=!1,orClauses=andClauses[i].orClauses,j=0;j<orClauses.length;j++){var clauseType=orClauses[j].clauseType,selector=orClauses[j].selector,dataLayerVariable="_TConnecto.dataLayer"+orClauses[j].dataLayerVariable,matchType=orClauses[j].matchType,value=orClauses[j].value,clauseMatch=!1;if(1==clauseType&&selector&&matchType&&value){var selectorElements=_TConnecto.Sizzle(selector),selectorValue,selectorValue,value;selectorElements&&0<selectorElements.length&&(selectorValue=selectorElements[0].textContent,selectorValue=selectorValue.toUpperCase(),value=value.toUpperCase(),_checkValueMatch(matchType,selectorValue,value)&&(clauseMatch=!0))}else if(2==clauseType&&_TConnecto.dataLayer&&dataLayerVariable&&matchType)try{var evaluatedDataLayerValue=eval(dataLayerVariable);evaluatedDataLayerValue=evaluatedDataLayerValue.toUpperCase(),value=value.toUpperCase(),_checkValueMatch(matchType,evaluatedDataLayerValue,value)&&(clauseMatch=!0)}catch(e){}else if(3==clauseType&&value)clauseMatch=eval("("+orClauses[j].value+")()");else if(4==clauseType&&_TConnecto.dataLayer&&dataLayerVariable&&matchType)try{var evaluatedDataLayerValue=eval(dataLayerVariable);evaluatedDataLayerValue=evaluatedDataLayerValue.toUpperCase();var segmentEvalFunctionResults=[];if(notification.segmentEvalFunctionResult&&notification.segmentEvalFunctionResult.attrDetails)for(var index in notification.segmentEvalFunctionResult.attrDetails){var attrDetail=notification.segmentEvalFunctionResult.attrDetails[index];segmentEvalFunctionResults.push(attrDetail.joinAttrVal.toUpperCase())}1!=matchType&&2!=matchType||!_checkValueMatch(matchType,segmentEvalFunctionResults,evaluatedDataLayerValue)||(clauseMatch=!0)}catch(e){}disjunction=disjunction||clauseMatch}conjunction=conjunction&&disjunction}return conjunction},_TConnecto._loadSizzleJS=function(){var e;"undefined"!=typeof Sizzle&&(e=Sizzle),"undefined"!=typeof require&&"undefined"!=typeof requirejs&&require&&requirejs?(require.config({paths:{_co_sizzle:"https://cdnjs.cloudflare.com/ajax/libs/sizzle/2.2.0/sizzle.min"}}),require(["_co_sizzle"],(function(e){_TConnecto.Sizzle=e}))):_loadScript("https://cdnjs.cloudflare.com/ajax/libs/sizzle/2.2.0/sizzle.min.js",(function(){Sizzle&&(_TConnecto.Sizzle=Sizzle,Sizzle=e,_processConnectoMessages())}))},_TConnecto.getMessage=function(e){return _TConnecto.messageMap[e]?_TConnecto.messageMap[e].notification:null},_TConnecto.showMessage=function(e){_TConnecto.messageMap[e]&&(_TConnecto.messageContentInserted[e]?document.getElementById("container-notification-frame-"+e).contentWindow.toggleWidget():(e=_TConnecto.messageMap[e],showContent(document.getElementById("container-notification-frame-"+e.id),htmlUnescape(e.innerHTML),e.delay,e.scroll,e)))},_TConnecto.stopMessage=function(e){_TConnecto.messageContentInserted[e]=!0},_TConnecto.getConnectoStorage=function(e){if(e=localStorage.getItem(e))try{return JSON.parse(e)}catch(e){return{}}return null},_TConnecto.initConnectoStorage=function(){if(localStorage.getItem("_connecto"))return _TConnecto.getConnectoStorage("_connecto");var e={source:document.referrer,landingPage:document.URL,firstVisitOn:new Date};return localStorage.setItem("_connecto",JSON.stringify(e)),e},_TConnecto.saveToConnectoStorage=function(e,t){var n=_TConnecto.getConnectoStorage("_connecto");(n=n||_TConnecto.initConnectoStorage())[e]=t,localStorage.setItem("_connecto",JSON.stringify(n))},_TConnecto.connectoLogsUpdated=!1,_TConnecto.updateConnectoLogs=function(){var e,t,n;_TConnecto.connectoLogsUpdated||(e=_TConnecto.getConnectoLogs(),t=new Date,e.pages.push({url:window.location.href,time:t}),0<e.sessions.length&&_TConnecto._readCookie("_co_session_active")?((n=e.sessions[e.sessions.length-1]).pagesViewed=n.pagesViewed?n.pagesViewed+1:1,n.lastPageLoadTime=t):e.sessions.push({startTime:t.getTime(),pagesViewed:1}),(n=new Date).setTime(t.getTime()+144e5),document.cookie="_co_session_active=1;expires="+n.toGMTString()+"; path=/",100<e.pages.length&&e.pages.shift(),50<e.sessions.length&&e.sessions.shift(),localStorage.setItem("_connecto_logs",JSON.stringify(e)),_TConnecto.connectoLogsUpdated=!0)},_TConnecto.getConnectoLogs=function(){var e={pages:[],sessions:[]},t=e,n=localStorage.getItem("_connecto_logs");if(n)try{t=JSON.parse(n)}catch(e){console.log("Error1 : err"+e),console.log("Error1 : stack"+e.stack)}return(t=t||e).pages&&"[object Array]"===Object.prototype.toString.call(t.pages)||(t.pages=[]),t.sessions&&"[object Array]"===Object.prototype.toString.call(t.sessions)||(t.sessions=[]),t},_TConnecto.getEventsSummary=function(){var e=localStorage.getItem("_co_events");if(e)try{return connectoEvents=JSON.parse(e),connectoEvents.summary}catch(e){console.log("Error1 : err"+e),console.log("Error1 : stack"+e.stack)}return null},_TConnecto._readCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var c=n[o];" "==c.charAt(0);)c=c.substring(1,c.length);if(0===c.indexOf(t))return c.substring(t.length,c.length)}return null},_TConnecto.getIdentity=function(){return _TConnecto.getFromConnectoEventStorage("userId")||_TConnecto.getAnonymousId()},_TConnecto.getAnonymousId=function(){return _TConnecto.getFromConnectoEventStorage("anonymousId")},_TConnecto.getFromConnectoEventStorage=function(e){var t=_TConnecto.getConnectoStorage("_Connecto");return t&&t[e]?t[e]:null},_TConnecto.getFromConnectoStorage=function(e){var t=_TConnecto.getConnectoStorage("_connecto");return t&&t[e]?t[e]:null},_TConnecto.updateState=function(id,state,data){var msg,msg="string"==typeof id?_TConnecto.getMessage(id):id;if(msg&&msg.triggerNotifications&&msg.triggerNotifications.callbackClick&&1==state&&eval("("+msg.triggerNotifications.callbackClick+")("+JSON.stringify(data)+")"),msg&&msg.triggerNotifications&&msg.triggerNotifications.callbackClose&&0==state&&eval("("+msg.triggerNotifications.callbackClose+")()"),_TConnecto.groups)for(var i=0;i<_TConnecto.groups.length;i++){var group=_TConnecto.groups[i];if(group.dontShowAfterFill&&1==state||group.dontShowAfterClose&&0==state)for(var j=0;j<_TConnecto.messages.length;j++){var message=_TConnecto.messages[j];_TConnecto.messageContentInserted[message.id]=!0}}},_TConnecto._processOnPageLoad=function(){_TConnecto.pageLoaded=!0;for(var e,t=document.getElementsByTagName("ins"),n=0;n<t.length;n++){var o=t[n].getAttribute("class");o&&-1<o.indexOf("connecto-notification")&&(e=t[n].getAttribute("data-connecto-slot"))&&(_TConnecto.embedElements[e]=t[n])}_processConnectoMessages()},_TConnecto._evaluateSegmentEvalFn=function(notification){if(notification.segmentId&&""!==notification.segmentId)try{notification.segmentEvalFunctionResult=eval(notification.segmentEvalFunction)}catch(e){console.log("It shoudn't have happened, check the evalFn of notificationId: "+notification._id),notification.segmentEvalFunctionResult={result:!1}}},_TConnecto.initialized||(_TConnecto.initialized=!0,"function"==typeof _TConnecto.initConnecto&&_TConnecto.initConnecto(),fetchMessages());