!function(e){var t={};function s(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(r,i,function(t){return e[t]}.bind(null,i));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=11)}([function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));const r=e=>{0}},function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var r={RecordingStates:{NONE:0,ALL:1,NO_DOM:2,NO_ERROR:3}}},function(e,t,s){let r={MODE:"development",API_URL:"http://localhost:3010/",WEBSOCKET_URL:"ws://localhost:3010/",CDN_URL:"http://localhost:3010/",JS_PATH:"js/"};r={MODE:"production",API_URL:"https://api.browsee.io/",WEBSOCKET_URL:"wss://session.browsee.io/",CDN_URL:"https://cdn.browsee.io/",JS_PATH:"js/"},e.exports=r},function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return i}));const r=e=>{var t=e.url,s=e.method||"POST",r=e.dataType||"application/json",i=e.withCredentials||!0,n=e.success,o=e.data||null,a=e.headers,c=new XMLHttpRequest;for(var d in c.open(s,t,!0),c.setRequestHeader("content-type",r),a)c.setRequestHeader(d,a[d]);c.withCredentials=i,c.onreadystatechange=function(){n&&4==this.readyState&&200==this.status&&n(this.responseText)},o?c.send(o):c.send()},i=function(e,t,s){var r=document.createElement("script");if(r.src=e,r.onload=s,r.onreadystatechange=s,t)t.appendChild(r);else{var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(r,i)}}},function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r={handlers:{password:function(e){return"p*s*w*r*d"},email:function(e){return"*****@*****"},tel:function(e){return"**********"},text:function(e){return"*****"},replace:function(e){return e.replace(/\S/g,".")}},tags:["input","textarea","select","datalist","option","output"],stopTypes:["password"],privateTypes:["email","tel"],inputTypes:["text","number","email","tel"],ignoreAttrs:["class","title","id"],fieldNames:["name","fullname","firstname","lastname","familyname","surname","address","address1","address2","addressline1","addressline2","cell","cellphone","mobile","phone","tel","telephone","dateofbirth","dob","birthdate","zip","zipcode","postalcode","email","username","nin","ppsn","security","securitynum","socialsec","socialsecuritynumber","socsec","ssn","adgangskode","authpw","contrasena","cc","cccsc","cccvc","cccvv","ccexp","ccexpiry","ccexpmonth","ccexpyear","ccname","ccnum","ccnumber","cctype","creditcard","csc","cvc","cvv","exp","accountnum","accountnumber","bic","iban","ibanaccountnum","ibanaccountnumber","pin","pinno","pinnum","secq","secret","secretq","secretquestion","securityq","securityquestion","sortcode","swift"],privacyType:{PRIVATE_INPUT_FIELDS:1,INPUT_FIELDS:2,PRIVATE_FIELDS_IN_PAGE:3,NO_TEXT:4}};class i{constructor(e){this.prefs=e,document&&(this.excludedList=document.querySelectorAll("[data-br-exclude]"))}shouldReplaceInputField(e,t,s){return!(!this.prefs.pr||!this.prefs.pr.length)||(!(!e||"password"!=e)||!!(e&&-1!=r.inputTypes.indexOf(e)||t&&-1!=r.fieldNames.indexOf(t)||t&&-1!=t.indexOf("password")||s&&-1!=r.fieldNames.indexOf(s)))}shouldObfuscateNode(e){return!(!e||-1==r.tags.indexOf(e.tagName.toLowerCase()))}hasExcludeAttribute(e){return!!(e&&e.hasAttribute&&e.hasAttribute("data-br-exclude"))}isExcluded(e){if(this.hasExcludeAttribute(e))return!0;if(this.excludedList)for(var t=0;t<this.excludedList.length;t++)if(this.excludedList[t].contains(e))return!0;return!1}maybeSensitive(e){return null!=e&&(-1!==e.indexOf("@")||/\d/.test(e))}obfuscatePrivateText(e){return this.maybeSensitive(e)?e.replace(/[0-9]/g,"X").replace(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi,"***@***").replace(/([a-zA-Z0-9._-]+@)/gi,"***@"):e}getObfuscatedValue(e){var t=e.value;if(this.isExcluded(e))return r.handlers.replace(t);var s=e.type?e.type.toLowerCase():void 0,i=e.name?e.name.toLowerCase():void 0,n=e.id?e.id.toLowerCase():void 0;e.tagName.toLowerCase();return this.shouldReplaceInputField(s,i,n)?this.obfuscateAttributeValue(s,t):t}handleAttributeObfuscation(e,t,s,i){if("value"==t){if(i)return r.handlers.replace(s);if(this.shouldObfuscateNode(e)){if(-1!==r.ignoreAttrs.indexOf(t))return s;var n=e.tagName.toLowerCase(),o=e.type?e.type.toLowerCase():void 0,a=e.name?e.name.toLowerCase():void 0,c=e.id?e.id.toLowerCase():void 0;if(this.shouldReplaceInputField(o,a,c))return"option"==n?null:this.obfuscateAttributeValue(o,s,a)}}return s}obfuscateAttributeValue(e,t,s){var i=t;return e&&-1!==r.stopTypes.indexOf(e)?r.handlers[e](i):s&&-1!==s.indexOf("password")?r.handlers.password(i):!this.prefs.pr||-1===this.prefs.pr.indexOf(r.privacyType.INPUT_FIELDS)&&-1===this.prefs.pr.indexOf(r.privacyType.NO_TEXT)?this.prefs.pr&&-1!==this.prefs.pr.indexOf(r.privacyType.PRIVATE_INPUT_FIELDS)?e&&-1!==r.privateTypes.indexOf(e)?r.handlers[e](i):this.obfuscatePrivateText(t):i:r.handlers.text(i)}handleTextNode(e,t){if(t)return r.handlers.replace(e);if(this.prefs.pr){if(-1!==this.prefs.pr.indexOf(r.privacyType.NO_TEXT))return e.replace(/\S/g,".");if(-1!==this.prefs.pr.indexOf(r.privacyType.PRIVATE_FIELDS_IN_PAGE))return this.obfuscatePrivateText(e)}return e}}},,,,,,,function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(0),n={EventTypes:{NETWORK_CALL:1,EVENT:2,URL:3,IDENTIFY:4,MOUSE:5,PAGE_LOAD:6,COMPONENTS:7,CUSTOM_EVENT:8,CLICK_EVENT:9},ComponentAnalyticsTypes:{VIEW:1,TIME:2,CLICK:3},BrowseeUrlParams:{RECORD:"brRecord",TEST_INSTALLATION:"brTestInstall"},s4:()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1),generate12DigitString:()=>Math.random().toString().slice(2,14),generate12CharacterString:()=>n.s4()+n.s4()+n.s4(),guid:()=>n.s4()+n.s4()+"-"+n.s4()+"-"+n.s4()+"-"+n.s4()+"-"+n.s4()+n.s4()+n.s4(),objectEquals:(e,t)=>{if(null==e||null==t)return e===t;if(e.constructor!==t.constructor)return!1;if(e instanceof Function)return e===t;if(e instanceof RegExp)return e===t;if(e===t||e.valueOf()===t.valueOf())return!0;if(Array.isArray(e)&&e.length!==t.length)return!1;if(e instanceof Date)return!1;if(!(e instanceof Object))return!1;if(!(t instanceof Object))return!1;var s=Object.keys(e);return Object.keys(t).every((function(e){return-1!==s.indexOf(e)}))&&s.every((function(s){return n.objectEquals(e[s],t[s])}))},getPercentScroll:e=>{var t=document.body.scrollHeight,s=window.scrollY;void 0!==e&&(s=e);var r=window.innerHeight+s;return Math.round(100*r/t)},isDnt:()=>!!(window.doNotTrack||navigator.doNotTrack||navigator.msDoNotTrack)&&!!("1"==window.doNotTrack||"yes"==navigator.doNotTrack||"1"==navigator.doNotTrack||"1"==navigator.msDoNotTrack||"msTrackingProtectionEnabled"in window.external&&window.external.msTrackingProtectionEnabled()),testInstallation:e=>{const t=e=>`color: ${e}; font-weight: bold;`;console.log("%c Browsee integrated successfully!",t("green")),n.isDnt()&&console.log("%c Do Not Track detected!",t("red")),e&&(console.log("%c Current Session",t("green")),console.log(e))},isASCII:e=>/^[\x00-\x7F]*$/.test(e)};class o{constructor(){this.options={selectors:["tag","id","class","nthchild"]},this.__indexOf=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1}}isElement(e){return!(1!==(null!=e?e.nodeType:void 0))}getParents(e){var t,s;if(s=[],this.isElement(e))for(t=e;this.isElement(t);)s.push(t),t=t.parentNode;return s}getTagSelector(e){return e.tagName.toLowerCase()}sanitizeItem(e){return escape(e).replace(/\%/g,"\\")}validateId(e){return null!=e&&(!/^\d/.exec(e)&&1===document.querySelectorAll("#"+e).length)}getIdSelector(e){var t;return null!=(t=e.getAttribute("id"))&&(t=this.sanitizeItem(t)),t=t=this.validateId(t)?"#"+t:null}getClassSelectors(e){var t,s,r;return r=[],null!=(t=e.getAttribute("class"))&&""!==(t=(t=t.replace(/\s+/g," ")).replace(/^\s|\s$/g,""))&&(r=function(){var e,r,i,n;for(n=[],e=0,r=(i=t.split(/\s+/)).length;e<r;e++)s=i[e],n.push("."+this.sanitizeItem(s));return n}.call(this)),r}getAttributeSelectors(e){var t,s,r,i,n,o,a;for(r=[],s=["id","class"],i=0,n=(o=e.attributes).length;i<n;i++)a=(t=o[i]).nodeName,this.__indexOf.call(s,a)<0&&r.push("["+t.nodeName+"="+t.nodeValue+"]");return r}getNthChildSelector(e){var t,s,r,i,n,o;if(null!=(s=e.parentNode))for(t=0,n=0,o=(i=s.childNodes).length;n<o;n++)if(r=i[n],this.isElement(r)&&(t++,r===e))return":nth-child("+t+")";return null}testSelector(e,t){var s,r;return s=!1,null!=t&&""!==t&&1===(r=e.ownerDocument.querySelectorAll(t)).length&&r[0]===e&&(s=!0),s}getAllSelectors(e){var t;return t={t:null,i:null,c:null,a:null,n:null},this.__indexOf.call(this.options.selectors,"tag")>=0&&(t.t=this.getTagSelector(e)),this.__indexOf.call(this.options.selectors,"id")>=0&&(t.i=this.getIdSelector(e)),this.__indexOf.call(this.options.selectors,"class")>=0&&(t.c=this.getClassSelectors(e)),this.__indexOf.call(this.options.selectors,"attribute")>=0&&(t.a=this.getAttributeSelector(e)),this.__indexOf.call(this.options.selectors,"nthchild")>=0&&(t.n=this.getNthChildSelector(e)),t}testUniqueness(e,t){var s;return 1===(s=e.parentNode.querySelectorAll(t)).length&&s[0]===e}getUniqueSelector(e){var t,s,r;if(null!=(r=this.getAllSelectors(e)).i)return r.i;if(this.testUniqueness(e,r.t))return r.t;if(0!==r.c.length){if(s=t=r.c.join(""),this.testUniqueness(e,s))return s;if(s=r.t+t,this.testUniqueness(e,s))return s}return r.n}getSelector(e){var t,s,r,i,n,o,a,c,d,l;for(t=[],a=0,d=(r=this.getParents(e)).length;a<d;a++)s=r[a],null!=(n=this.getUniqueSelector(s))&&t.push(n);for(o=[],c=0,l=t.length;c<l;c++)if(s=t[c],o.unshift(s),i=o.join(" > "),this.testSelector(e,i))return i;return null}targetProperties(e){var t={nodeName:e.nodeName.toLowerCase()};if(e.id&&(t.domId=e.id),e.name&&(t.name=e.name),e.textContent){var s=e.textContent.replace(/^\s+/,"").replace(/\s+$/,"");s.length>200&&(s=s.substring(0,200)+"..."),t.text=s}try{t.cssSelector=this.getSelector(e)}catch(e){t.cssSelector=""}const r=["alt","src","value","type","action","onclick","href","target"],i=["password","email","phone"];if(e.attributes){for(var n=e.attributes,o=0;o<n.length;o++){var a=n[o];-1!==r.indexOf(a.name)&&(t.attributes||(t.attributes={}),t.attributes[a.name]=a.value)}t.attributes&&-1!=i.indexOf(t.attributes.type)&&delete t.attributes.value}return t}}const a=["input","textarea","select","option"],c=["input","textarea","select","option","pre","code","canvas"],d=["button","a"],l={attributes:!0,childList:!0,subtree:!0},h=1,u=2,g=3,p=4,v=(e,t)=>{const s=e.x-t.x,r=e.y-t.y;return s*s+r*r};class m{constructor(e){this.clickSequence=[],this.clickChanges={},this.selectorGenerator=new o,this.lastNetworkCallTime=(new Date).getTime(),this.lastMutationTime=(new Date).getTime(),this.sendClickData=e}triggerClickData(e,t,s,r){var i=t.event,n=this.selectorGenerator.targetProperties(i.target),o=i.target.getBoundingClientRect(),a=Math.round(100*(i.clientX-o.left)/o.width),c=Math.round(100*(i.clientY-o.top)/o.height);this.sendClickData(e,{x:t.x,y:t.y,percentX:a,percentY:c,scrollX:t.scrollX,scrollY:t.scrollY},n,s,t.time)}triggerRageClick(e,t){Object(i.a)("This is a rage click: "+e.event.pageX+":"+e.event.pageY),this.triggerClickData(h,e,t)}triggerDeadClick(e,t){Object(i.a)("That was a dead click: "+e.event.pageX+":"+e.event.pageY),this.triggerClickData(u,e,t)}setObserver(){var e=window.document.getElementsByTagName("body")[0];if(!this.observer){var t=this;this.observer=new MutationObserver((function(e){t.updateMutation(e)})),this.observer.observe(e,l)}}disconnectObserver(){this.observer&&(this.observer.disconnect(),this.observer=null)}updateClick(e,t,s){var r=document.location.pathname+document.location.hash,n=Math.floor(99999999*Math.random()+1);const o=e.event.target.tagName.toLowerCase();if(!this.shouldIgnoreForRageClick(o)){this.clickSequence.push({x:e.x,y:e.y}),this.checkSequenceProximity()&&(Object(i.a)("Rage Click"),this.triggerRageClick(e,r),this.resetClickTimers()),this.rageClickTimer&&window.clearTimeout(this.rageClickTimer);var a=this;this.rageClickTimer=window.setTimeout((function(){a.resetClickTimers()}),1500)}if(this.isActionableTarget(o))s(p);else{var c=u;this.isCTATarget(o)&&(Object(i.a)("CTA click"),c=g),this.currentClick=n,this.setObserver();var d=(new Date).getTime();a=this;window.setTimeout((function(){var t=document.location.pathname+document.location.hash;if(r==t&&a&&d>a.lastNetworkCallTime&&d>a.lastMutationTime&&c!=g)a.triggerDeadClick(e,r),s(u,{});else{var i=a.clickChanges[n];i||(i={}),r!==t&&(i.url=t),s(g,i),delete a.clickChanges[n]}a.currentClick==n&&(a.currentClick=null),a.disconnectObserver()}),1e3)}}updateNetworkCall(e){this.currentClick&&(this.clickChanges[this.currentClick]||(this.clickChanges[this.currentClick]={}),this.clickChanges[this.currentClick].calls||(this.clickChanges[this.currentClick].calls=[]),this.clickChanges[this.currentClick].calls.push(e)),this.lastNetworkCallTime=(new Date).getTime()}updateMutation(e){var t=0;e.forEach((function(e){e.addedNodes&&1==e.addedNodes.length&&"html2canvas-container"==e.addedNodes[0].className||e.removedNodes&&1==e.removedNodes.length&&"html2canvas-container"==e.removedNodes[0].className||t++})),t>0&&(this.currentClick&&(this.clickChanges[this.currentClick]||(this.clickChanges[this.currentClick]={}),this.clickChanges[this.currentClick].mutations=!0),this.lastMutationTime=(new Date).getTime())}resetClickTimers(){this.clickSequence=[]}isActionableTarget(e){return-1!=a.indexOf(e)}isCTATarget(e){return-1!=d.indexOf(e)}shouldIgnoreForRageClick(e){return-1!=c.indexOf(e)}checkSequenceProximity(){if(this.clickSequence.length<4)return!1;for(var e=JSON.parse(JSON.stringify(this.clickSequence)),t=0;t<e.length;t++){const s=0==t?e.length-1:t-1;if(v(e[s],e[t])>1e4)return!1}return!0}}var f=s(4);const w=["text","password","file","datetime","datetime-local","date","month","time","week","number","range","email","url","search","tel","color"];class S{constructor(e,t,s){this.eventHandlers={},this.preventClick=!1,this.preventClickTwice=!1,this.typeLock=0,this.enterTarget=null,this.prevTimeOut=null,this.readyTimeOut=null,this.pageLoaded=!0,this.recordEvent=e,this.obfuscator=new f.a(s),this.selectorGenerator=new o,this.checkUrl=t,this.addEventHandler("type","change",this.typeEventHandler),this.addEventHandler("clickAt","click",this.clickAtEventHandler,!0),this.addEventHandler("scroll","scroll",this.scrollEventHandler,!0),this.addEventHandler("checkPageLoaded","readystatechange",this.pageLoadEventHandler,!0),this.addEventHandler("select","focus",this.selectFocusEventHandler,!0),this.addEventHandler("blur","blur",this.blurFocusEventHandler,!0),this.addEventHandler("change","change",this.selectChangeEventHandler),this.addEventHandler("move","mousemove",this.mouseMovementHandler,!0),this.addEventHandler("blur","blur",this.windowBlurEventHandler,!0,!0),this.addEventHandler("focus","focus",this.windowFocusEventHandler,!0,!0),this.addEventHandler("resize","resize",this.windowResizeEventHandler,!0,!0)}attach(){if(!this.attached){this.attached=!0,this.eventListeners={};var e=this;for(let o in this.eventHandlers){var t=JSON.parse(o),s=t.eventName,r=t.capture,i=t.isWindow;function n(){var t=this.eventHandlers[o],n=function(s){for(var r=0;r<t.length;r++)t[r].call(e,s)};i?window.addEventListener(s,n,r):window.document.addEventListener(s,n,r),this.eventListeners[o]=n}n.call(this)}}}detach(){if(this.attached){this.attached=!1;for(let r in this.eventListeners){var e=JSON.parse(r),t=e.eventName,s=e.capture;e.isWindow?window.removeEventListener(t,this.eventListeners[r],s):window.document.removeEventListener(t,this.eventListeners[r],s)}delete this.eventListeners}}addEventHandler(e,t,s,r,i){s.handlerName=e;let n=JSON.stringify({eventName:t,capture:r,isWindow:i});this.eventHandlers[n]||(this.eventHandlers[n]=[]),this.eventHandlers[n].push(s)}typeEventHandler(e){if(e.target.tagName&&0==this.typeLock&&(this.typeLock=1)){var t=e.target.tagName.toLowerCase(),s=e.target.type,r=e.target.getBoundingClientRect(),i=window.scrollX,n=window.scrollY,o=r.left+i,a=r.top+n;("input"==t&&w.indexOf(s)>=0||"textarea"==t)&&(e.target.value.length>0&&window._browsee.sessionRecorder&&window._browsee.sessionRecorder.mirrorClient&&window._browsee.sessionRecorder.mirrorClient.applySimulated({added:[],characterDataChanged:[],removed:[],reordered:[],reparented:[],attributeChanged:{value:[e.target]}}),this.recordEvent("type",this.selectorGenerator.targetProperties(e.target),this.obfuscator.getObfuscatedValue(e.target),o,a,i,n))}this.typeLock=0}clickAtEventHandler(e){if(0==e.button&&!this.preventClick&&e.isTrusted){if(!this.preventClickTwice){var t=e.target.getBoundingClientRect(),s=Math.round(100*(e.clientX-t.left)/t.width),r=Math.round(100*(e.clientY-t.top)/t.height);e.target;this.recordEvent("clickAt",this.selectorGenerator.targetProperties(e.target),s+","+r,e.pageX,e.pageY,window.scrollX,window.scrollY,e),this.preventClickTwice=!0}var i=this;setTimeout((function(){i.preventClickTwice=!1}),30)}}doubleClickAtEventHandler(e){var t=e.target.getBoundingClientRect();Math.round(100*(e.pageX-t.left)/t.width),Math.round(100*(e.pageY-t.top)/t.height)}dispatchMouseMovents(){if(this.movements&&this.movements.length){var e=Object.assign({},{movements:this.movements});this.recordEvent("mouseMove",e),delete this.movements}}mouseMovementHandler(e){this.movements||(this.movements=[]);var t=(new Date).getTime();(t-this.lastMouseMovement>5||!this.lastMouseMovement)&&this.movements.push([e.clientX,e.clientY,t]),this.lastMouseMovement=t,clearTimeout(this.mouseDispatchTimeout),this.mouseDispatchTimeout=setTimeout(this.dispatchMouseMovents.bind(this),500)}scrollEventHandler(e){if(!0===this.pageLoaded){var t=this;this.currentScroll;this.scrollDetector=e.target;var s=window.scrollY;this.scrollDetector!==window.document&&(s=this.scrollDetector.scrollTop),this.currentScroll||(this.currentScroll=s),clearTimeout(this.prevTimeOut),this.prevTimeOut=setTimeout(function(){var e={start:window.innerHeight+t.currentScroll,end:window.innerHeight+s,viewHeight:window.innerHeight},r=null;this.scrollDetector!==window.document&&(r=this.selectorGenerator.targetProperties(this.scrollDetector),Object(i.a)("Scroll of: ",e.element)),this.recordEvent("scroll",e,r,null,null,window.scrollX,s),delete t.scrollDetector,delete t.currentScroll}.bind(t),100)}}pageLoadEventHandler(e){var t=this;"interactive"!==window.document.readyState&&"loaded"!==window.document.readyState||this.checkUrl(),"loading"===window.document.readyState?this.pageLoaded=!1:"interactive"===window.document.readyState||(this.pageLoaded=!1,clearTimeout(this.readyTimeOut),this.readyTimeOut=setTimeout(function(){t.pageLoaded=!0}.bind(t),500))}selectFocusEventHandler(e){if(e.target.nodeName){var t=e.target.nodeName.toLowerCase();if("select"==t&&e.target.multiple)for(var s=e.target.options,r=0;r<s.length;r++)null==s[r]._wasSelected&&(s[r]._wasSelected=s[r].selected);-1!==["input","select"].indexOf(t)?(this.inputFocusTarget=e.target,this.inputFocusTime=(new Date).getTime()):this.inputFocusTarget=null}}blurFocusEventHandler(e){if(e.target.nodeName&&this.inputFocusTarget&&this.inputFocusTarget==e.target){var t=(new Date).getTime()-this.inputFocusTime;this.recordEvent("input",this.selectorGenerator.targetProperties(e.target),t,e.pageX,e.pageY,window.scrollX,window.scrollY)}}windowBlurEventHandler(e){e.target.nodeName||this.recordEvent("blur")}windowFocusEventHandler(e){e.target.nodeName||this.recordEvent("focus")}windowResizeEventHandler(){var e=this;clearTimeout(this.prevResizeTimeOut),this.prevResizeTimeOut=setTimeout((function(){e.recordEvent("resize",{width:window.innerWidth,height:window.innerHeight})}),100)}getOptionLocator(e){var t=e.text.replace(/^ *(.*?) *$/,"$1");return t.match(/\xA0/)?"label=regexp:"+t.replace(/[\(\)\[\]\\\^\$\*\+\?\.\|\{\}]/g,(function(e){return"\\"+e})).replace(/\s+/g,(function(e){return e.match(/\xA0/)?e.length>1?"\\s+":"\\s":e})):"label="+t}selectChangeEventHandler(e){if(e.target.tagName&&"select"==e.target.tagName.toLowerCase())if(e.target.multiple){for(var t=e.target.options,s=0;s<t.length;s++)if(t[s]._wasSelected,t[s]._wasSelected!=t[s].selected){var r=this.getOptionLocator(t[s]);t[s].selected?this.recordEvent("addSelection",this.selectorGenerator.targetProperties(e.target),r,e.pageX,e.pageY,window.scrollX,window.scrollY):this.recordEvent("removeSelection",this.selectorGenerator.targetProperties(e.target),r,e.pageX,e.pageY,window.scrollX,window.scrollY),t[s]._wasSelected=t[s].selected}}else{var i=e.target.options[e.target.selectedIndex];this.recordEvent("select",this.selectorGenerator.targetProperties(e.target),this.getOptionLocator(i),e.pageX,e.pageY,window.scrollX,window.scrollY),window._browsee.sessionRecorder&&window._browsee.sessionRecorder.mirrorClient&&window._browsee.sessionRecorder.mirrorClient.applySimulated({added:[],characterDataChanged:[],removed:[],reordered:[],reparented:[],attributeChanged:{selected:[i]}})}}}s(2);class T{constructor(e,t,s){this.events=[],this.session=e,this.transport=t,this.trackHandler=s}sendEvents(){this.transport.socketSend({f:"events",events:this.events}),this.events=[]}addMouseEvent(e,t,s){this.events&&this.events.length>0&&this.events[this.events.length-1].type==e&&this.events[this.events.length-1].url==t?this.events[this.events.length-1].mouseData.push(s):this.events.push({type:e,url:t,etime:this.session.getEngagementTime(),pagetime:this.session.getPageTimeSpent(),stime:this.session.getSessionTimeSpent(),width:window.innerWidth,height:window.innerHeight,mouseData:[s]})}addEvent(e,t,s){this.events||(this.events=[]),e==n.EventTypes.MOUSE?this.addMouseEvent(e,t,s):this.events.push({type:e,url:t,etime:this.session.getEngagementTime(),pagetime:this.session.getPageTimeSpent(),stime:this.session.getSessionTimeSpent(),data:s}),this.nextbatch&&window.clearTimeout(this.nextbatch),this.nextbatch=window.setTimeout(this.sendEvents.bind(this),500)}}class E{generateEventId(){return Math.floor(99999999*Math.random()+1)}getStoredEvents(){var e=sessionStorage.getItem("_browsee_temp");return e?JSON.parse(e):{}}storeEvents(e){sessionStorage.setItem("_browsee_temp",JSON.stringify(e))}storeEvent(e,t){var s=this.getStoredEvents();s[e]=t,this.storeEvents(s)}deleteEvent(e){var t=this.getStoredEvents();delete t[e],this.storeEvents(t)}deleteAll(){sessionStorage.removeItem("_browsee_temp")}}const b=function(e,t,s){var r=JSON.stringify({_id:e,_identified:t,_p:s});n.isASCII(r)&&(r=btoa(r)),localStorage.setItem("_brId",r)};class y{constructor(e,t){this.init(e,t)}init(e,t){if(null!=e)return this.id=e,this.identified=!0,this.params=t||{},void b(this.id,this.identified,this.params);var s=function(){var e=localStorage.getItem("_brId");try{return"{"!==e[0]&&n.isASCII(e)?JSON.parse(atob(e)):"{"==e[0]?JSON.parse(e):null}catch(e){return null}}();s?(this.id=s._id,this.identified=s._identified,this.params=s._p):(this.id=n.guid(),this.identified=!1,this.params={},b(this.id,this.identified,this.params))}getId(){return this.id}getParams(){return this.params}isIdentified(){return this.identified}identify(e,t){if(e!=this.id||!n.objectEquals(t,this.params)){var s=this.id;return this.id=e,this.identified=!0,this.params=t,b(this.id,this.identified,this.params),s}return null}}class k{constructor(){this.reset(),this.engagementTime=0}reset(){this.start=(new Date).getTime(),this.updateEvent()}getEngagementTime(){return this.engagementTime}updateEvent(){this.start?this.engagementTime=(new Date).getTime()-this.start:this.start=(new Date).getTime(),this.eventTimer&&window.clearTimeout(this.eventTimer);var e=this;this.eventTimer=window.setTimeout((function(){e.creditEngagement()}),6e4)}creditEngagement(){this.start&&(this.engagementTime=(new Date).getTime()-this.start,this.start=null)}}const O=()=>n.generate12CharacterString(),C=(e,t,s,r)=>{localStorage.setItem("_browsee",JSON.stringify({_id:e,_t:t,_r:s,_p:r}))},_=e=>{localStorage.setItem("_brt",JSON.stringify({_t:e}))},N=e=>L(e,localStorage),L=(e,t)=>{var s=t.getItem(e);return s?JSON.parse(s):null},I=18e5;class x{constructor(e){this.initSession(),this.setSessionUrl(e)}initSession(){var e=N("_browsee"),t=N("_brt");this.handleWindowId(),!e||!t||this.lastEvent&&(new Date).getTime()-this.lastEvent>I||t&&(new Date).getTime()-t._t>I?this.createNewSession():(this.sessionId=e._id,this.sessionTime=e._t,this.record=e._r,this.prefs={},void 0!==e._c&&(this.prefs.co=e._c),void 0!==e._e&&(this.prefs.et=e._e),void 0!==e._p&&(this.prefs=e._p),this.initReferrer()),window.addEventListener("beforeunload",this.onUnload.bind(this))}setSessionId(e){this.sessionId=e||O(),this.sessionTime=(new Date).getTime(),C(this.sessionId,this.sessionTime,this.record,this.prefs)}initReferrer(){var e=L("_br_ref",sessionStorage);e?(this.referrer=e.ref,this.landingPage=e.lp):this.getSessionReferrer()}getId(){return this.sessionId}getWindowId(){return this.windowId}onUnload(){sessionStorage.setItem("_brlwId",this.windowId)}handleWindowId(){var e=sessionStorage.getItem("_brlwId");e?sessionStorage.removeItem("_brlwId"):e=n.s4(),this.windowId=e}getSessionState(){return this.hasSessionState()?{rec:this.record,prefs:this.prefs}:null}hasOverride(){return void 0!==this.overrideRecord}getOverride(){return this.overrideRecord}hasSessionState(){return void 0!==this.record&&null!==this.record&&void 0===this.overrideRecord||void 0!==this.prefs&&Object.keys(this.prefs).length}setSessionState(e){this.hasOverride()?this.record=this.overrideRecord:this.record=e.rec,e.prefs?this.prefs=e.prefs:(this.prefs.et=e.et,this.prefs.co=e.co),C(this.sessionId,this.sessionTime,this.record,this.prefs)}setRecordingState(e){this.record=e,C(this.sessionId,this.sessionTime,this.record,this.prefs)}setRecordingOverride(e){this.overrideRecord=e,this.record=e}getRecordingState(){return this.record}getSessionStartTime(){return this.sessionTime}getSessionTimeSpent(){return(new Date).getTime()-this.sessionTime}getPageLoadedTime(){return this.pageLoadedTime}getPageTimeSpent(){return(new Date).getTime()-this.pageLoadedTime.getTime()}getSessionUrl(){return this.sessionUrl}getEngagementTime(){return this.engagementTimer.getEngagementTime()}getReferrer(){return this.referrer}getLandingPage(){return this.landingPage}createNewSession(){this.prefs={},this.record=null,this.sessionId=O(),this.sessionTime=(new Date).getTime(),C(this.sessionId,this.sessionTime),this.initReferrer()}getSessionReferrer(){var e,t;this.referrer=window.document.referrer,this.landingPage=window.location.href,e=this.referrer,t=this.landingPage,sessionStorage.setItem("_br_ref",JSON.stringify({ref:e,lp:t}))}updateEvent(){return this.lastEvent&&(new Date).getTime()-this.lastEvent>I?(this.createNewSession(),this.engagementTimer.reset(),this.lastEvent=(new Date).getTime(),_(this.lastEvent),this.engagementTimer.updateEvent(),!0):(this.lastEvent=(new Date).getTime(),_(this.lastEvent),this.engagementTimer.updateEvent(),!1)}setSessionUrl(e){return this.sessionUrl&&this.sessionUrl==e?(this.updateEvent(),!1):(this.sessionUrl=e,this.pageLoadedTime=new Date,delete this.engagementTimer,this.engagementTimer=new k,this.updateEvent(),!0)}}const R=s(2).WEBSOCKET_URL+"session";class A{constructor(e,t,s,r){this.init(),this.apiKey=e,this.session=t,this.user=s,this.messageHandler=r,this.queue=[]}init(){this.socket||(this.socket=new WebSocket(R),this.socket.onopen=this.onOpen.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this))}reset(){this.socket=new WebSocket(R),this.socket.onopen=this.onOpen.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this)}socketSend(e){if(this.socket||this.init(),this.socket&&this.socket.readyState!==this.socket.OPEN)this.queue.push(e);else{var t={apiKey:this.apiKey,sessionId:this.session.getId(),wId:this.session.getWindowId(),record:this.session.getRecordingState(),url:this.session.getSessionUrl(),time:this.session.getSessionTimeSpent()};e.session=t,this.socket.send(JSON.stringify(e))}}onOpen(){var e={f:"start",width:window.innerWidth,height:window.innerHeight,scrollX:window.scrollX,scrollY:window.scrollY,referrer:this.session.getReferrer(),landingPage:this.session.getLandingPage(),user:this.user.getId(),identified:this.user.isIdentified(),userParams:this.user.getParams()};if(this.socketSend(e),this.queue.length>0){for(var t=0;t<this.queue.length;t++)this.socketSend(this.queue[t]);this.queue=[]}}onMessage(e){try{var t=JSON.parse(e.data);this.messageHandler&&this.messageHandler(t)}catch(t){Object(i.a)("Invalid JSON: ",e.data)}}onClose(){this.socket=void 0}onError(e){Object(i.a)("Error in Websocket")}}var D=s(3),P=window._browsee||[];const U=()=>{var e=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(){this._brrequestId=Math.floor(99999999*Math.random()+1);const t=[].slice.call(arguments);return this._method=t[0],this._url=t[1],e.apply(this,t)};var t=window.XMLHttpRequest.prototype.send;window.XMLHttpRequest.prototype.send=function(){var e=this.onreadystatechange,s=function(){e&&e.apply(this,[].slice.call(arguments)),4==this.readyState&&P.trackResponse(this._brrequestId,this.status,this._url)};e?this.onreadystatechange=s:this.addEventListener("readystatechange",s);var r=t.apply(this,[].slice.call(arguments));return P.trackSend(this._brrequestId,this._method,this._url),r}};var H={metrics:["navigationStart","domainLookupEnd","connectEnd","requestStart","responseEnd","domInteractive","domContentLoadedEventStart","domComplete","loadEventStart"],getLoadNumbers:function(){var e={};if("performance"in window&&"PerformanceObserver"in window){var t=window.performance.timing.navigationStart;H.metrics.forEach((s=>{e[s]=window.performance.timing[s]-t}))}return e},getGaExperiment:function(){try{if(gaData&&Object.keys(gaData)&&Object.keys(gaData).length){var e=Object.keys(gaData)[0];if(gaData[e]&&gaData[e].experiments&&Object.keys(gaData[e].experiments).length){var t=Object.keys(gaData[e].experiments)[0];return t+"-"+gaData[e].experiments[t]}}}catch(e){}return null}};const M=s(2);var q=window._browsee||function(){(q.q=q.q||[]).push(arguments)};q.pUrl=function(){return document.location.pathname+document.location.hash},q.checkUrl=function(){if(q.session&&q.recorder&&q.session.setSessionUrl(document.location.href)){q.recorder.addEvent(n.EventTypes.URL,q.pUrl(),{scroll:window.innerHeight+window.scrollY,scrollY:window.scrollY});var e=new Event("br_page_change");window.dispatchEvent(e)}},q.checkUrlAndAddEvent=function(e,t,s){q.checkUrl(),q.recorder&&q.recorder.addEvent(e,t,s),q.checkUrlEvent&&clearTimeout(q.checkUrlEvent),q.checkUrlEvent=setTimeout(q.checkUrl,200)},q.trackSend=function(e,t,s){const r=(new Date).getTime();q.requests||(q.requests={}),s&&s.split&&-1==s.indexOf(M.API_URL)&&!q.requests[e]&&window.document.hasFocus()&&(q.requests[e]={start:r,method:t,url:s.split("?")[0]},q.checkUrlAndAddEvent(n.EventTypes.NETWORK_CALL,q.pUrl(),q.requests[e]),q.clickTracker&&q.clickTracker.updateNetworkCall(q.requests[e]))},q.trackResponse=function(e,t,s){const r=(new Date).getTime();var i;q.requests&&q.requests[e]&&window.document.hasFocus()&&((i=Object.assign?Object.assign({},q.requests[e]):JSON.parse(JSON.stringify(q.requests[e]))).statusCode=t,i.time=r-i.start,i.stime=q.session.getSessionTimeSpent(),delete i.start,q.checkUrlAndAddEvent(1,q.pUrl(),i),delete q.requests[e])},q.recordEvent=function(e,t,s,r,o,a,c,d){q.session&&(q.session.updateEvent()&&q.getSessionState());const l=q.session.getPageTimeSpent(),h=q.session.getSessionTimeSpent(),u=q.session.getSessionStartTime(),g=q.pUrl();var v;if(q.recorder&&"mouseMove"==e)return t.movements&&(t.movements.forEach((e=>{e[2]-=u})),v=t.movements),void q.recorder.addEvent(n.EventTypes.MOUSE,g,{x:r,y:o,scrollX:a,scrollY:c,time:l,stime:h,movements:v});Object(i.a)("Recording: "+e+" at: "+l);var m={url:g,type:e,properties:t,time:l,stime:h,wId:q.session.getWindowId(),target:s,x:r,y:o,scrollX:a,scrollY:c};if("clickAt"==e||"doubleClickAt"==e){var f=null;q.eventStore&&(f=q.eventStore.generateEventId(),q.eventStore.storeEvent(f,JSON.stringify(m))),q.clickTracker.updateClick({event:d,x:r,y:o,scrollX:a,scrollY:c,time:h},"doubleClickAt"==e,(function(e,t){q.eventStore&&q.eventStore.deleteEvent(f),e==p&&Object(i.a)("Dead or input click");var s=m,r=s.url;delete s.url,delete s.wId,s.changes=t,s.position=s.target,delete s.target,q.checkUrlAndAddEvent(n.EventTypes.EVENT,r,s)}))}else{var w=m;delete w.url,delete w.wId,"input"==e&&(w.inputtime=w.target,delete w.target),q.checkUrlAndAddEvent(n.EventTypes.EVENT,g,w)}},q.sendStoredEvents=function(){if(q.eventStore){var e=q.eventStore.getStoredEvents();for(var t in e)if(e.hasOwnProperty(t)){var s=JSON.parse(e[t]),r=s.url;s.wId==q.session.getWindowId()&&(s.position=s.target,delete s.target,delete s.url,delete s.wId,i=s,q.checkUrlAndAddEvent(n.EventTypes.EVENT,r,i))}q.eventStore.deleteAll()}var i},q.sendClickData=function(e,t,s,r,i){var o={type:e,url:r,properties:s,wId:q.session.getWindowId(),time:i,coords:t};q.checkUrlAndAddEvent(n.EventTypes.CLICK_EVENT,r,o)},q.handleSocketResponse=function(e){e.record&&(q.session.setRecordingState(e.record),e.record==r.a.RecordingStates.ALL&&q.load("replay.min.js","Recorder Loaded"))},q.handleTrackResponse=function(e){var t=JSON.parse(e);t.elements&&t.elements.length},q.findOffset=function(e,t){var s=e.getBoundingClientRect(),r={x:0,y:0};return t.x&&t.y&&(r.x=t.x-s.x,r.y=t.y-s.y),r},q.sendPageLoad=function(){if(q.pageLoad&&q.recorder){var e=q.pageLoad;return void q.recorder.addEvent(n.EventTypes.PAGE_LOAD,e.url,{scroll:e.scroll,scrollY:window.scrollY,experiment:e.experiment,performance:e.performance})}const t=q.pUrl(),s=window.innerHeight+window.scrollY,r=H.getLoadNumbers(),i=H.getGaExperiment();q.recorder?q.recorder.addEvent(n.EventTypes.PAGE_LOAD,t,{scroll:s,experiment:i,performance:r}):q.pageLoad={url:t,scroll:s,experiment:i,performance:r}},q.onPageLoad=function(){"complete"===document.readyState?q.sendPageLoad():document.addEventListener("readystatechange",(function(e){"complete"===e.target.readyState&&q.sendPageLoad()}))},q.getSessionState=function(){q.user=q.user||new y;var e=M.API_URL+"sessionstate?_a="+q.apiKey+"&_u="+q.user.getId()+"&_d="+(n.isDnt()?"1":"0")+"&_l="+encodeURIComponent(q.pUrl());q.session.hasOverride()&&(e+="&_o="+q.session.getOverride()),Object(D.a)({url:e,method:"GET",dataType:"text/plain",withCredentials:!1,success:function(e){if(e){var t=JSON.parse(e);q.session.setSessionState(t),q.setSession(q.session.getSessionState()),t&&t.prefs&&t.prefs.it&&t.prefs.it.length&&q.load("integrations.min.js","Integrations Loaded")}}})},q.setTestParams=function(){if(document.location.search&&URLSearchParams){var e=new URLSearchParams(document.location.search);e.has(n.BrowseeUrlParams.RECORD)&&q.session?q.session.setRecordingState(r.a.RecordingStates.ALL):e.has(n.BrowseeUrlParams.TEST_INSTALLATION)&&n.testInstallation(q.getRecordingUrl())}},q.setRecording=function(e){q.session=new x(document.location.href),q.session.setRecordingOverride(e?r.a.RecordingStates.ALL:r.a.RecordingStates.NONE)},q.resetSession=function(e){q.session=new x(document.location.href),q.session.setSessionId(e)},q.onLoad=function(){if(q.loaded)Object(i.a)("Browsee already loaded.");else{q.session||(this.url=document.location.href,q.session=new x(this.url)),q.setTestParams(),q.onPageLoad();var e=q.session.getSessionState();e?q.setSession(e):q.getSessionState(),q.loaded=!0}},q.load=function(e,t){Object(D.b)(M.CDN_URL+M.JS_PATH+e,document.body,(function(){Object(i.a)(t)}))},q.setSession=function(e){if(void 0!==e.rec&&null!==e.rec){var t=e.rec;Object(i.a)("Setting record state: "+e.rec),t!==r.a.RecordingStates.NONE&&(q.user=q.user||new y,q.transport=new A(q.apiKey,q.session,q.user,q.handleSocketResponse),q.eventTracker=new S(q.recordEvent,q.checkUrl,q.session.getSessionState().prefs),q.eventTracker.attach(),delete q.clickTracker,q.clickTracker=new m(q.sendClickData),q.recorder=new T(q.session,q.transport,q.handleTrackResponse),q.eventStore=new E,q.sendStoredEvents(),q.recorder.addEvent(n.EventTypes.URL,q.pUrl(),{scroll:window.innerHeight+window.scrollY,scrollY:window.scrollY}),q.pageLoad&&q.sendPageLoad(),U(),(s=window.fetch)&&(window.fetch=function(){var e=[].slice.call(arguments);const t=e[1]?e[1].method:"GET",r=e[0];return new Promise((function(i,n){var o=Math.floor(99999999*Math.random()+1);s.apply(window,e).then((function(e){i(e),P.trackResponse(o,e.status)})).catch((function(e){n(e),P.trackResponse(o,e.status)})),P.trackSend(o,t,r)}))}),t!==r.a.RecordingStates.NO_DOM&&(q.resetSessionRecorder?q.resetSessionRecorder():q.load("replay.min.js","Recorder Loaded")),(e.prefs.et||null==e.prefs.et)&&(q.setErrorTracker?q.setErrorTracker():q.load("raven.min.js","Raven Loaded")))}var s;e.prefs.co&&q.load("components.min.js","Components Loaded"),q.replaceQueue()},q.init=function(e){q.apiKey=e},q.logEvent=function(e,t){if(!(null==e||"string"!=typeof e||e.length>250))return q.recorder&&q.recorder.addEvent(n.EventTypes.CUSTOM_EVENT,q.pUrl(),{text:e,params:t}),!0;console.log("%c Event names must be valid text","color: red; font-weight: bold;")},q.identify=function(e,t){if(null!=e&&"string"==typeof e){if(q.user){var s=q.user.identify(e,t);s&&q.recorder&&q.recorder.addEvent(n.EventTypes.IDENTIFY,q.pUrl(),{id:e,params:t,anonymousId:s})}else q.user=new y(e,t);return!0}console.log("%c Invalid ID provided to identify call","color: red; font-weight: bold;")},q.getRecordingUrl=function(e){var t="";q.session&&(q.session.getRecordingState()==r.a.RecordingStates.ALL&&(t="https://browsee.io/app/session/"+q.session.getId()));return e&&e(t),t},q.getSessionUrl=function(e){var t="https://browsee.io/app/session/";return q.session&&(t+=q.session.getId()),e&&e(t),t},q.applyMethod=function(e){var t=[].slice.call(e),s=t.shift();if(q[s])try{q[s].apply(null,t)}catch(e){console.error(e)}},q.processQueue=function(){for(var e=q.q.length,t=0;t<e;t++)q.applyMethod(q.q.shift())},q.replaceQueue=function(){q.q.length&&q.processQueue(),q.q.push=function(e){q.applyMethod(e)}},Object(i.a)("Browsee loaded"),q.q&&(q.processQueue(),q.onLoad())}]);